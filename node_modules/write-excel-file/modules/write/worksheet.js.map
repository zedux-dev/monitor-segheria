{"version":3,"file":"worksheet.js","names":["generateRows","generateColumnsDescription","processMergedCells","generateMergedCellsDescription","generateLayout","generateViews","WORKSHEET_TEMPLATE","generateWorksheet","data_","schema","columns","getHeaderStyle","getStyle","getSharedString","customFont","dateFormat","orientation","stickyRowsCount","stickyColumnsCount","showGridLines","rightToLeft","sheetId","validateData","data","mergedCells","replace","Array","isArray","TypeError","length"],"sources":["../../source/write/worksheet.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/templates/worksheet.xml.js\r\n\r\nimport generateRows from './rows.js'\r\nimport generateColumnsDescription from './columns.js'\r\nimport processMergedCells from './processMergedCells.js'\r\nimport generateMergedCellsDescription from './generateMergedCellsDescription.js'\r\nimport generateLayout from './layout.js'\r\nimport generateViews from './views.js'\r\n\r\n// const WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n// <worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\"><sheetData>{data}</sheetData></worksheet>`;\r\n\r\nconst WORKSHEET_TEMPLATE = `<?xml version=\"1.0\" ?>\r\n<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:mv=\"urn:schemas-microsoft-com:mac:vml\" xmlns:mx=\"http://schemas.microsoft.com/office/mac/excel/2008/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:x14=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\" xmlns:xm=\"http://schemas.microsoft.com/office/excel/2006/main\">{views}{columnsDescription}<sheetData>{data}</sheetData>{mergedCellsDescription}{layout}</worksheet>`;\r\n\r\nexport default function generateWorksheet(data_, {\r\n\tschema,\r\n\tcolumns,\r\n\tgetHeaderStyle,\r\n\tgetStyle,\r\n\tgetSharedString,\r\n\tcustomFont,\r\n\tdateFormat,\r\n\torientation,\r\n\tstickyRowsCount,\r\n\tstickyColumnsCount,\r\n\tshowGridLines,\r\n\trightToLeft,\r\n\tsheetId\r\n}) {\r\n\tvalidateData(data_, { schema })\r\n\r\n\tconst { data, mergedCells } = processMergedCells(data_, { schema })\r\n\r\n  return WORKSHEET_TEMPLATE\r\n  \t.replace('{data}', generateRows(data, {\r\n  \t\tschema,\r\n  \t\tgetHeaderStyle,\r\n  \t\tgetStyle,\r\n  \t\tgetSharedString,\r\n  \t\tcustomFont,\r\n  \t\tdateFormat\r\n  \t}))\r\n  \t.replace('{views}', generateViews({ stickyRowsCount, stickyColumnsCount, showGridLines, rightToLeft }))\r\n  \t.replace('{columnsDescription}', generateColumnsDescription({ schema, columns }))\r\n  \t.replace('{mergedCellsDescription}', generateMergedCellsDescription(mergedCells))\r\n  \t.replace('{layout}', generateLayout({ sheetId, orientation }))\r\n}\r\n\r\nfunction validateData(data, { schema }) {\r\n\tif (schema) {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of objects')\r\n\t\t}\r\n\t} else {\r\n\t\tif (!Array.isArray(data)) {\r\n\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t}\r\n\t\tif (data.length > 0) {\r\n\t\t\tif (!Array.isArray(data[0])) {\r\n\t\t\t\tthrow new TypeError('Expected an array of arrays')\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}"],"mappings":"AAAA;AACA;AACA;AAEA,OAAOA,YAAP,MAAyB,WAAzB;AACA,OAAOC,0BAAP,MAAuC,cAAvC;AACA,OAAOC,kBAAP,MAA+B,yBAA/B;AACA,OAAOC,8BAAP,MAA2C,qCAA3C;AACA,OAAOC,cAAP,MAA2B,aAA3B;AACA,OAAOC,aAAP,MAA0B,YAA1B,C,CAEA;AACA;;AAEA,IAAMC,kBAAkB,wrBAAxB;AAGA,eAAe,SAASC,iBAAT,CAA2BC,KAA3B,QAcZ;EAAA,IAbFC,MAaE,QAbFA,MAaE;EAAA,IAZFC,OAYE,QAZFA,OAYE;EAAA,IAXFC,cAWE,QAXFA,cAWE;EAAA,IAVFC,QAUE,QAVFA,QAUE;EAAA,IATFC,eASE,QATFA,eASE;EAAA,IARFC,UAQE,QARFA,UAQE;EAAA,IAPFC,UAOE,QAPFA,UAOE;EAAA,IANFC,WAME,QANFA,WAME;EAAA,IALFC,eAKE,QALFA,eAKE;EAAA,IAJFC,kBAIE,QAJFA,kBAIE;EAAA,IAHFC,aAGE,QAHFA,aAGE;EAAA,IAFFC,WAEE,QAFFA,WAEE;EAAA,IADFC,OACE,QADFA,OACE;EACFC,YAAY,CAACd,KAAD,EAAQ;IAAEC,MAAM,EAANA;EAAF,CAAR,CAAZ;;EAEA,0BAA8BP,kBAAkB,CAACM,KAAD,EAAQ;IAAEC,MAAM,EAANA;EAAF,CAAR,CAAhD;EAAA,IAAQc,IAAR,uBAAQA,IAAR;EAAA,IAAcC,WAAd,uBAAcA,WAAd;;EAEC,OAAOlB,kBAAkB,CACvBmB,OADK,CACG,QADH,EACazB,YAAY,CAACuB,IAAD,EAAO;IACrCd,MAAM,EAANA,MADqC;IAErCE,cAAc,EAAdA,cAFqC;IAGrCC,QAAQ,EAARA,QAHqC;IAIrCC,eAAe,EAAfA,eAJqC;IAKrCC,UAAU,EAAVA,UALqC;IAMrCC,UAAU,EAAVA;EANqC,CAAP,CADzB,EASLU,OATK,CASG,SATH,EAScpB,aAAa,CAAC;IAAEY,eAAe,EAAfA,eAAF;IAAmBC,kBAAkB,EAAlBA,kBAAnB;IAAuCC,aAAa,EAAbA,aAAvC;IAAsDC,WAAW,EAAXA;EAAtD,CAAD,CAT3B,EAULK,OAVK,CAUG,sBAVH,EAU2BxB,0BAA0B,CAAC;IAAEQ,MAAM,EAANA,MAAF;IAAUC,OAAO,EAAPA;EAAV,CAAD,CAVrD,EAWLe,OAXK,CAWG,0BAXH,EAW+BtB,8BAA8B,CAACqB,WAAD,CAX7D,EAYLC,OAZK,CAYG,UAZH,EAYerB,cAAc,CAAC;IAAEiB,OAAO,EAAPA,OAAF;IAAWL,WAAW,EAAXA;EAAX,CAAD,CAZ7B,CAAP;AAaD;;AAED,SAASM,YAAT,CAAsBC,IAAtB,SAAwC;EAAA,IAAVd,MAAU,SAAVA,MAAU;;EACvC,IAAIA,MAAJ,EAAY;IACX,IAAI,CAACiB,KAAK,CAACC,OAAN,CAAcJ,IAAd,CAAL,EAA0B;MACzB,MAAM,IAAIK,SAAJ,CAAc,8BAAd,CAAN;IACA;EACD,CAJD,MAIO;IACN,IAAI,CAACF,KAAK,CAACC,OAAN,CAAcJ,IAAd,CAAL,EAA0B;MACzB,MAAM,IAAIK,SAAJ,CAAc,6BAAd,CAAN;IACA;;IACD,IAAIL,IAAI,CAACM,MAAL,GAAc,CAAlB,EAAqB;MACpB,IAAI,CAACH,KAAK,CAACC,OAAN,CAAcJ,IAAI,CAAC,CAAD,CAAlB,CAAL,EAA6B;QAC5B,MAAM,IAAIK,SAAJ,CAAc,6BAAd,CAAN;MACA;IACD;EACD;AACD"}