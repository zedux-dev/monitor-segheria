{"version":3,"file":"writeXlsxFileBrowser.js","names":["JSZip","FileSaver","generateWorkbookXml","generateWorkbookXmlRels","rels","contentTypes","generateSheets","writeXlsxFile","data","fileName","rest","generateXlsxFile","then","blob","saveAs","sheetName","sheet","sheetNames","sheets","schema","columns","headerStyle","getHeaderStyle","fontFamily","fontSize","orientation","stickyRowsCount","stickyColumnsCount","showGridLines","rightToLeft","dateFormat","zip","file","getSharedStringsXml","getStylesXml","xl","folder","id","generateAsync","type","mimeType","compression"],"sources":["../../source/write/writeXlsxFileBrowser.js"],"sourcesContent":["// Copy-pasted from:\r\n// https://github.com/davidramos-om/zipcelx-on-steroids/blob/master/src/zipcelx.js\r\n\r\nimport JSZip from 'jszip'\r\nimport FileSaver from 'file-saver'\r\n\r\nimport generateWorkbookXml from './statics/workbook.xml.js'\r\nimport generateWorkbookXmlRels from './statics/workbook.xml.rels.js'\r\nimport rels from './statics/rels.js'\r\nimport contentTypes from './statics/[Content_Types].xml.js'\r\n\r\nimport { generateSheets } from './writeXlsxFile.common.js'\r\n\r\nexport default function writeXlsxFile(data, { fileName, ...rest } = {}) {\r\n  return generateXlsxFile(data, rest).then((blob) => {\r\n    if (fileName) {\r\n      return FileSaver.saveAs(blob, fileName)\r\n    }\r\n    return blob\r\n  })\r\n}\r\n\r\n/**\r\n * Writes an *.xlsx file into a \"blob\".\r\n * https://github.com/egeriis/zipcelx/issues/68\r\n * \"The reason if you want to send the excel file or store it natively on Cordova/capacitor app\".\r\n * @return {Blob}\r\n */\r\nfunction generateXlsxFile(data, {\r\n  sheet: sheetName,\r\n  sheets: sheetNames,\r\n  schema,\r\n  columns,\r\n  headerStyle,\r\n  getHeaderStyle,\r\n  fontFamily,\r\n  fontSize,\r\n  orientation,\r\n  stickyRowsCount,\r\n  stickyColumnsCount,\r\n  showGridLines,\r\n  rightToLeft,\r\n  dateFormat\r\n}) {\r\n  const zip = new JSZip()\r\n\r\n  zip.file('_rels/.rels', rels)\r\n  zip.file('[Content_Types].xml', contentTypes)\r\n\r\n  const {\r\n    sheets,\r\n    getSharedStringsXml,\r\n    getStylesXml\r\n  } = generateSheets({\r\n    data,\r\n    sheetName,\r\n    sheetNames,\r\n    schema,\r\n    columns,\r\n    headerStyle,\r\n    getHeaderStyle,\r\n    fontFamily,\r\n    fontSize,\r\n    orientation,\r\n    stickyRowsCount,\r\n    stickyColumnsCount,\r\n    showGridLines,\r\n    rightToLeft,\r\n    dateFormat\r\n  })\r\n\r\n  const xl = zip.folder('xl')\r\n  xl.file('_rels/workbook.xml.rels', generateWorkbookXmlRels({ sheets }))\r\n  xl.file('workbook.xml', generateWorkbookXml({ sheets, stickyRowsCount, stickyColumnsCount }))\r\n  xl.file('styles.xml', getStylesXml())\r\n  xl.file('sharedStrings.xml', getSharedStringsXml())\r\n\r\n  for (const { id, data } of sheets) {\r\n    xl.file(`worksheets/sheet${id}.xml`, data)\r\n  }\r\n\r\n  return zip.generateAsync({\r\n    type: 'blob',\r\n    mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n    compression: 'deflate'\r\n  })\r\n}"],"mappings":"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"}