{"version":3,"file":"writeXlsxFile.common.js","names":["generateWorksheet","initStyles","initSharedStrings","validateSheetName","generateSheets","data","sheetName","sheetNames","schema","columns","headerStyle","getHeaderStyle","fontFamily","fontSize","orientation","stickyRowsCount","stickyColumnsCount","showGridLines","rightToLeft","dateFormat","getSharedStringsXml","getSharedString","getStylesXml","getStyle","Array","isArray","Error","worksheets","sheetIndex","sheet","push","customFont","sheetId","sheets","map","i","id","name"],"sources":["../../source/write/writeXlsxFile.common.js"],"sourcesContent":["import generateWorksheet from './worksheet.js'\r\nimport initStyles from './styles.js'\r\nimport initSharedStrings from './sharedStrings.js'\r\nimport validateSheetName from './validateSheetName.js'\r\n\r\nexport function generateSheets({\r\n  data,\r\n  sheetName,\r\n  sheetNames,\r\n  schema,\r\n  columns,\r\n  headerStyle,\r\n  getHeaderStyle,\r\n  fontFamily,\r\n  fontSize,\r\n  orientation,\r\n  stickyRowsCount,\r\n  stickyColumnsCount,\r\n  showGridLines,\r\n  rightToLeft,\r\n  dateFormat\r\n}) {\r\n  const { getSharedStringsXml, getSharedString } = initSharedStrings()\r\n  const { getStylesXml, getStyle } = initStyles({ fontFamily, fontSize })\r\n\r\n  // Versions before `1.3.4` had a bug:\r\n  // In a \"write multiple sheets\" scenario, `columns` parameter\r\n  // wasn't required to be an array of `columns` for each sheet.\r\n  if (sheetNames) {\r\n    if (columns) {\r\n      if (!Array.isArray(columns[0])) {\r\n        throw new Error('In a \"write multiple sheets\" scenario, `columns` parameter must be an array of `columns` for each sheet.');\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!sheetNames) {\r\n    sheetNames = [sheetName || 'Sheet1']\r\n    data = [data]\r\n    if (columns) {\r\n      columns = [columns]\r\n    }\r\n    if (schema) {\r\n      schema = [schema]\r\n    }\r\n  }\r\n\r\n  // Rename deprecated `headerStyle` parameter to `getHeaderStyle(column)`.\r\n  if (headerStyle && !getHeaderStyle) {\r\n    getHeaderStyle = () => headerStyle\r\n  }\r\n\r\n  // Validate sheet name.\r\n  for (const sheetName of sheetNames) {\r\n    validateSheetName(sheetName)\r\n  }\r\n\r\n  const worksheets = []\r\n  let sheetIndex = 0\r\n  for (const sheet of sheetNames) {\r\n    worksheets.push(generateWorksheet(data[sheetIndex], {\r\n      schema: schema && schema[sheetIndex],\r\n      columns: columns && columns[sheetIndex],\r\n      getHeaderStyle,\r\n      getStyle,\r\n      getSharedString,\r\n      customFont: fontFamily || fontSize,\r\n      dateFormat,\r\n      orientation,\r\n      stickyRowsCount,\r\n      stickyColumnsCount,\r\n      showGridLines,\r\n      rightToLeft,\r\n      sheetId: sheetIndex + 1\r\n    }))\r\n    sheetIndex++\r\n  }\r\n\r\n  return {\r\n    sheets: sheetNames.map((sheetName, i) => ({\r\n      id: i + 1,\r\n      name: sheetName,\r\n      data: worksheets[i]\r\n    })),\r\n    getSharedStringsXml,\r\n    getStylesXml\r\n  }\r\n}"],"mappings":"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"}